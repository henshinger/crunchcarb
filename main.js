async function getData() {
    const response = await fetch("/data.json");
    const json = await response.json();
    return json;
};
document.addEventListener('alpine:init', () => {
    Alpine.store('text', {
        input_text: '',
        output_text: '',
        news_feed:  [
            {"title": "UN climate talks reach halftime with key issues unresolved", "url": "https://abcnews.go.com/International/wireStory/climate-talks-halftime-key-issues-unresolved-93165250", "date": "13 Nov, 2022", "publication": "abc News", "body": "SHARM EL-SHEIKH, Egypt -- It's half-way time at the U.N. climate talks in Egypt, with negotiators still working on draft agreements before ministers arrive next week to push for a substantial deal to fight climate change.\n\nThe two-week meeting in Sharm el-Sheikh started with strong appeals from world leaders for greater efforts to curb greenhouse gas emissions and help poor nations cope with global warming.\n\nScientists say the amount of greenhouse gases being pumped into the atmosphere needs to be halved by 2030 to meet the goals of the Paris climate accord. The 2015 pact set a target of ideally limiting temperature rise to 1.5 degrees Celsius (2.7 degrees Fahrenheit) by the end of the century, but left it up to countries to decide how they want to do so.\n\nHere is a look at the main issues on the table at the COP27 talks:\n\nWHAT ABOUT THE U.S. AND CHINA?\n\nThe top U.S. negotiator suggested that a planned meeting Monday between U.S. President Joe Biden and President Xi Jinping of China on the sideline of the Group of 20 meeting in Bali could also provide an important signal for the climate talks as they go into the home stretch.\n\nWith impacts from climate change already felt across the globe, there's been a push for rich polluters to stump up more cash to help developing countries shift to clean energy and adapt to global warming; increasingly there are also calls for compensation to pay for climate-related losses.\n\nChina is the biggest polluter by far right now, but the U.S. has the most historical pollution over time.\n\nKEEPING COOL\n\nA group of major emerging countries that includes oil-and-gas exporting nations has pushed back against explicit references to keeping the target of limiting global warming to under 1.5 degrees Celsius. Egypt, which is chairing the talks, convened a three-hour meeting Saturday in which the issue was raised several times.\n\n“1.5 is a substantive issue,” said Wael Aboulmagd, a senior Egyptian negotiator, adding that it was “not just China” which had raised questions about the language used to refer to the target. Still, he was hopeful of finding a way of securing a “maximum possible advance” on reducing emissions by the meeting's close.\n\nCUTTING EMISSIONS\n\nNegotiators are trying to put together a mitigation program that would capture the different measures countries have committed to in order to reduce emissions, including for specific sectors like energy and transport. Many of these pledges are not formally part of the U.N. process, meaning they cannot easily be scrutinized at the annual meeting. A draft agreement circulated early Saturday had more than 200 square brackets, meaning large sections were still unresolved. Some countries want the plan to be valid only for one year, while others say a longer-term roadmap is needed. Expect fireworks in the days ahead.\n\nUS-CHINA RELATIONS\n\nWhile all countries are equal at the U.N. meeting, in practice little gets done without the approval of the world's two biggest emitters, China and the United States. Beijing canceled formal dialogue on climate following Speaker Nancy Pelosi's visit to Taiwan and relations have been frosty since. U.S. climate envoy John Kerry said Saturday that he had only held informal discussions with his Chinese counterpart Xie Zhenhua lately. “I think we’re both waiting to see how things go with the G-20 and hopefully we can return,” he told reporters.\n\nSHUNNING FOSSIL FUELS\n\nLast year's meeting almost collapsed over a demand for the final agreement to state that coal should be phased out. In the end, countries agreed on several loopholes, and there are concerns among climate activists that negotiators from nations which are heavily dependent on fossil fuels might try to roll back previous commitments.\n\nMONEY MATTERS\n\nRich countries have fallen short on a pledge to mobilize $100 billion a year by 2020 in climate financing for poor nations. This has opened up a rift of distrust that negotiators are hoping to close with fresh pledges. But needs are growing and a new, higher target needs to be set from 2025 onward.\n\nAminath Shauna, the environment minister of the Maldives, said her island nation conservatively estimates that it will need $8 billion for coastal adaptation. And even that may not be enough, if sea levels rise too much. “It is very disheartening to see that it may be too late for the Maldives, but we still need to address (the issue of finance),” she said.\n\nCOMPENSATION\n\nThe subject of climate compensation was once considered taboo, due to concerns from rich countries that they might be on the hook for vast sums. But intense pressure from developing countries forced the issue of “loss and damage” onto the formal agenda at the talks for the first time this year. Whether there will be a deal to promote further technical work or the creation of an actual fund remains to be seen.\n\nJohn Kerry said the United States is hopeful of getting an agreement “before 2024” but suggested this might not come to pass in Egypt. But he made it clear where the U.S. red line lies for Washington: ”The United States and many other countries will not establish some ... legal structure that is a tied to compensation or liability.\" That doesn't mean money won't flow, eventually. But it might be branded as aid, tied into existing funds and require contributions from all major emitters if it's to pass.\n\nMORE DONORS\n\nOne way to raise additional cash and resolve the thorny issue of polluter payment would be for those countries that have seen an economic boom in the past three decades to step up. The focus is chiefly on China, the world’s biggest emitter, but others could be asked to open their purses too.\n\nSIDE DEALS\n\nLast year's meeting saw a raft of agreements signed which weren't formally part of the talks. Some have also been unveiled in Egypt, though hopes for a series of announcements on Just Transition Partnerships — where developed countries help poorer nations wean themselves off fossil fuels — aren't likely to bear fruit until after COP27.\n\nHOPE TILL THE END\n\nJennifer Morgan, a former head of Greenpeace who recently became Germany's climate envoy, called the talks this year “challenging.”\n\n“But I can promise you we will be working until the very last second to ensure that we can reach an ambitious and equitable outcome,” she said. “We are reaching for the stars while keeping our feet on the ground.”"},
            {"title": "UN climate talks reach halftime with key issues unresolved", "url": "https://abcnews.go.com/International/wireStory/climate-talks-halftime-key-issues-unresolved-93165250", "date": "13 Nov, 2022", "publication": "abc News", "body": "SHARM EL-SHEIKH, Egypt -- It's half-way time at the U.N. climate talks in Egypt, with negotiators still working on draft agreements before ministers arrive next week to push for a substantial deal to fight climate change.\n\nThe two-week meeting in Sharm el-Sheikh started with strong appeals from world leaders for greater efforts to curb greenhouse gas emissions and help poor nations cope with global warming.\n\nScientists say the amount of greenhouse gases being pumped into the atmosphere needs to be halved by 2030 to meet the goals of the Paris climate accord. The 2015 pact set a target of ideally limiting temperature rise to 1.5 degrees Celsius (2.7 degrees Fahrenheit) by the end of the century, but left it up to countries to decide how they want to do so.\n\nHere is a look at the main issues on the table at the COP27 talks:\n\nWHAT ABOUT THE U.S. AND CHINA?\n\nThe top U.S. negotiator suggested that a planned meeting Monday between U.S. President Joe Biden and President Xi Jinping of China on the sideline of the Group of 20 meeting in Bali could also provide an important signal for the climate talks as they go into the home stretch.\n\nWith impacts from climate change already felt across the globe, there's been a push for rich polluters to stump up more cash to help developing countries shift to clean energy and adapt to global warming; increasingly there are also calls for compensation to pay for climate-related losses.\n\nChina is the biggest polluter by far right now, but the U.S. has the most historical pollution over time.\n\nKEEPING COOL\n\nA group of major emerging countries that includes oil-and-gas exporting nations has pushed back against explicit references to keeping the target of limiting global warming to under 1.5 degrees Celsius. Egypt, which is chairing the talks, convened a three-hour meeting Saturday in which the issue was raised several times.\n\n“1.5 is a substantive issue,” said Wael Aboulmagd, a senior Egyptian negotiator, adding that it was “not just China” which had raised questions about the language used to refer to the target. Still, he was hopeful of finding a way of securing a “maximum possible advance” on reducing emissions by the meeting's close.\n\nCUTTING EMISSIONS\n\nNegotiators are trying to put together a mitigation program that would capture the different measures countries have committed to in order to reduce emissions, including for specific sectors like energy and transport. Many of these pledges are not formally part of the U.N. process, meaning they cannot easily be scrutinized at the annual meeting. A draft agreement circulated early Saturday had more than 200 square brackets, meaning large sections were still unresolved. Some countries want the plan to be valid only for one year, while others say a longer-term roadmap is needed. Expect fireworks in the days ahead.\n\nUS-CHINA RELATIONS\n\nWhile all countries are equal at the U.N. meeting, in practice little gets done without the approval of the world's two biggest emitters, China and the United States. Beijing canceled formal dialogue on climate following Speaker Nancy Pelosi's visit to Taiwan and relations have been frosty since. U.S. climate envoy John Kerry said Saturday that he had only held informal discussions with his Chinese counterpart Xie Zhenhua lately. “I think we’re both waiting to see how things go with the G-20 and hopefully we can return,” he told reporters.\n\nSHUNNING FOSSIL FUELS\n\nLast year's meeting almost collapsed over a demand for the final agreement to state that coal should be phased out. In the end, countries agreed on several loopholes, and there are concerns among climate activists that negotiators from nations which are heavily dependent on fossil fuels might try to roll back previous commitments.\n\nMONEY MATTERS\n\nRich countries have fallen short on a pledge to mobilize $100 billion a year by 2020 in climate financing for poor nations. This has opened up a rift of distrust that negotiators are hoping to close with fresh pledges. But needs are growing and a new, higher target needs to be set from 2025 onward.\n\nAminath Shauna, the environment minister of the Maldives, said her island nation conservatively estimates that it will need $8 billion for coastal adaptation. And even that may not be enough, if sea levels rise too much. “It is very disheartening to see that it may be too late for the Maldives, but we still need to address (the issue of finance),” she said.\n\nCOMPENSATION\n\nThe subject of climate compensation was once considered taboo, due to concerns from rich countries that they might be on the hook for vast sums. But intense pressure from developing countries forced the issue of “loss and damage” onto the formal agenda at the talks for the first time this year. Whether there will be a deal to promote further technical work or the creation of an actual fund remains to be seen.\n\nJohn Kerry said the United States is hopeful of getting an agreement “before 2024” but suggested this might not come to pass in Egypt. But he made it clear where the U.S. red line lies for Washington: ”The United States and many other countries will not establish some ... legal structure that is a tied to compensation or liability.\" That doesn't mean money won't flow, eventually. But it might be branded as aid, tied into existing funds and require contributions from all major emitters if it's to pass.\n\nMORE DONORS\n\nOne way to raise additional cash and resolve the thorny issue of polluter payment would be for those countries that have seen an economic boom in the past three decades to step up. The focus is chiefly on China, the world’s biggest emitter, but others could be asked to open their purses too.\n\nSIDE DEALS\n\nLast year's meeting saw a raft of agreements signed which weren't formally part of the talks. Some have also been unveiled in Egypt, though hopes for a series of announcements on Just Transition Partnerships — where developed countries help poorer nations wean themselves off fossil fuels — aren't likely to bear fruit until after COP27.\n\nHOPE TILL THE END\n\nJennifer Morgan, a former head of Greenpeace who recently became Germany's climate envoy, called the talks this year “challenging.”\n\n“But I can promise you we will be working until the very last second to ensure that we can reach an ambitious and equitable outcome,” she said. “We are reaching for the stars while keeping our feet on the ground.”"},
            {"title": "UN climate talks reach halftime with key issues unresolved", "url": "https://abcnews.go.com/International/wireStory/climate-talks-halftime-key-issues-unresolved-93165250", "date": "13 Nov, 2022", "publication": "abc News", "body": "SHARM EL-SHEIKH, Egypt -- It's half-way time at the U.N. climate talks in Egypt, with negotiators still working on draft agreements before ministers arrive next week to push for a substantial deal to fight climate change.\n\nThe two-week meeting in Sharm el-Sheikh started with strong appeals from world leaders for greater efforts to curb greenhouse gas emissions and help poor nations cope with global warming.\n\nScientists say the amount of greenhouse gases being pumped into the atmosphere needs to be halved by 2030 to meet the goals of the Paris climate accord. The 2015 pact set a target of ideally limiting temperature rise to 1.5 degrees Celsius (2.7 degrees Fahrenheit) by the end of the century, but left it up to countries to decide how they want to do so.\n\nHere is a look at the main issues on the table at the COP27 talks:\n\nWHAT ABOUT THE U.S. AND CHINA?\n\nThe top U.S. negotiator suggested that a planned meeting Monday between U.S. President Joe Biden and President Xi Jinping of China on the sideline of the Group of 20 meeting in Bali could also provide an important signal for the climate talks as they go into the home stretch.\n\nWith impacts from climate change already felt across the globe, there's been a push for rich polluters to stump up more cash to help developing countries shift to clean energy and adapt to global warming; increasingly there are also calls for compensation to pay for climate-related losses.\n\nChina is the biggest polluter by far right now, but the U.S. has the most historical pollution over time.\n\nKEEPING COOL\n\nA group of major emerging countries that includes oil-and-gas exporting nations has pushed back against explicit references to keeping the target of limiting global warming to under 1.5 degrees Celsius. Egypt, which is chairing the talks, convened a three-hour meeting Saturday in which the issue was raised several times.\n\n“1.5 is a substantive issue,” said Wael Aboulmagd, a senior Egyptian negotiator, adding that it was “not just China” which had raised questions about the language used to refer to the target. Still, he was hopeful of finding a way of securing a “maximum possible advance” on reducing emissions by the meeting's close.\n\nCUTTING EMISSIONS\n\nNegotiators are trying to put together a mitigation program that would capture the different measures countries have committed to in order to reduce emissions, including for specific sectors like energy and transport. Many of these pledges are not formally part of the U.N. process, meaning they cannot easily be scrutinized at the annual meeting. A draft agreement circulated early Saturday had more than 200 square brackets, meaning large sections were still unresolved. Some countries want the plan to be valid only for one year, while others say a longer-term roadmap is needed. Expect fireworks in the days ahead.\n\nUS-CHINA RELATIONS\n\nWhile all countries are equal at the U.N. meeting, in practice little gets done without the approval of the world's two biggest emitters, China and the United States. Beijing canceled formal dialogue on climate following Speaker Nancy Pelosi's visit to Taiwan and relations have been frosty since. U.S. climate envoy John Kerry said Saturday that he had only held informal discussions with his Chinese counterpart Xie Zhenhua lately. “I think we’re both waiting to see how things go with the G-20 and hopefully we can return,” he told reporters.\n\nSHUNNING FOSSIL FUELS\n\nLast year's meeting almost collapsed over a demand for the final agreement to state that coal should be phased out. In the end, countries agreed on several loopholes, and there are concerns among climate activists that negotiators from nations which are heavily dependent on fossil fuels might try to roll back previous commitments.\n\nMONEY MATTERS\n\nRich countries have fallen short on a pledge to mobilize $100 billion a year by 2020 in climate financing for poor nations. This has opened up a rift of distrust that negotiators are hoping to close with fresh pledges. But needs are growing and a new, higher target needs to be set from 2025 onward.\n\nAminath Shauna, the environment minister of the Maldives, said her island nation conservatively estimates that it will need $8 billion for coastal adaptation. And even that may not be enough, if sea levels rise too much. “It is very disheartening to see that it may be too late for the Maldives, but we still need to address (the issue of finance),” she said.\n\nCOMPENSATION\n\nThe subject of climate compensation was once considered taboo, due to concerns from rich countries that they might be on the hook for vast sums. But intense pressure from developing countries forced the issue of “loss and damage” onto the formal agenda at the talks for the first time this year. Whether there will be a deal to promote further technical work or the creation of an actual fund remains to be seen.\n\nJohn Kerry said the United States is hopeful of getting an agreement “before 2024” but suggested this might not come to pass in Egypt. But he made it clear where the U.S. red line lies for Washington: ”The United States and many other countries will not establish some ... legal structure that is a tied to compensation or liability.\" That doesn't mean money won't flow, eventually. But it might be branded as aid, tied into existing funds and require contributions from all major emitters if it's to pass.\n\nMORE DONORS\n\nOne way to raise additional cash and resolve the thorny issue of polluter payment would be for those countries that have seen an economic boom in the past three decades to step up. The focus is chiefly on China, the world’s biggest emitter, but others could be asked to open their purses too.\n\nSIDE DEALS\n\nLast year's meeting saw a raft of agreements signed which weren't formally part of the talks. Some have also been unveiled in Egypt, though hopes for a series of announcements on Just Transition Partnerships — where developed countries help poorer nations wean themselves off fossil fuels — aren't likely to bear fruit until after COP27.\n\nHOPE TILL THE END\n\nJennifer Morgan, a former head of Greenpeace who recently became Germany's climate envoy, called the talks this year “challenging.”\n\n“But I can promise you we will be working until the very last second to ensure that we can reach an ambitious and equitable outcome,” she said. “We are reaching for the stars while keeping our feet on the ground.”"},
            {"title": "UN climate talks reach halftime with key issues unresolved", "url": "https://abcnews.go.com/International/wireStory/climate-talks-halftime-key-issues-unresolved-93165250", "date": "13 Nov, 2022", "publication": "abc News", "body": "SHARM EL-SHEIKH, Egypt -- It's half-way time at the U.N. climate talks in Egypt, with negotiators still working on draft agreements before ministers arrive next week to push for a substantial deal to fight climate change.\n\nThe two-week meeting in Sharm el-Sheikh started with strong appeals from world leaders for greater efforts to curb greenhouse gas emissions and help poor nations cope with global warming.\n\nScientists say the amount of greenhouse gases being pumped into the atmosphere needs to be halved by 2030 to meet the goals of the Paris climate accord. The 2015 pact set a target of ideally limiting temperature rise to 1.5 degrees Celsius (2.7 degrees Fahrenheit) by the end of the century, but left it up to countries to decide how they want to do so.\n\nHere is a look at the main issues on the table at the COP27 talks:\n\nWHAT ABOUT THE U.S. AND CHINA?\n\nThe top U.S. negotiator suggested that a planned meeting Monday between U.S. President Joe Biden and President Xi Jinping of China on the sideline of the Group of 20 meeting in Bali could also provide an important signal for the climate talks as they go into the home stretch.\n\nWith impacts from climate change already felt across the globe, there's been a push for rich polluters to stump up more cash to help developing countries shift to clean energy and adapt to global warming; increasingly there are also calls for compensation to pay for climate-related losses.\n\nChina is the biggest polluter by far right now, but the U.S. has the most historical pollution over time.\n\nKEEPING COOL\n\nA group of major emerging countries that includes oil-and-gas exporting nations has pushed back against explicit references to keeping the target of limiting global warming to under 1.5 degrees Celsius. Egypt, which is chairing the talks, convened a three-hour meeting Saturday in which the issue was raised several times.\n\n“1.5 is a substantive issue,” said Wael Aboulmagd, a senior Egyptian negotiator, adding that it was “not just China” which had raised questions about the language used to refer to the target. Still, he was hopeful of finding a way of securing a “maximum possible advance” on reducing emissions by the meeting's close.\n\nCUTTING EMISSIONS\n\nNegotiators are trying to put together a mitigation program that would capture the different measures countries have committed to in order to reduce emissions, including for specific sectors like energy and transport. Many of these pledges are not formally part of the U.N. process, meaning they cannot easily be scrutinized at the annual meeting. A draft agreement circulated early Saturday had more than 200 square brackets, meaning large sections were still unresolved. Some countries want the plan to be valid only for one year, while others say a longer-term roadmap is needed. Expect fireworks in the days ahead.\n\nUS-CHINA RELATIONS\n\nWhile all countries are equal at the U.N. meeting, in practice little gets done without the approval of the world's two biggest emitters, China and the United States. Beijing canceled formal dialogue on climate following Speaker Nancy Pelosi's visit to Taiwan and relations have been frosty since. U.S. climate envoy John Kerry said Saturday that he had only held informal discussions with his Chinese counterpart Xie Zhenhua lately. “I think we’re both waiting to see how things go with the G-20 and hopefully we can return,” he told reporters.\n\nSHUNNING FOSSIL FUELS\n\nLast year's meeting almost collapsed over a demand for the final agreement to state that coal should be phased out. In the end, countries agreed on several loopholes, and there are concerns among climate activists that negotiators from nations which are heavily dependent on fossil fuels might try to roll back previous commitments.\n\nMONEY MATTERS\n\nRich countries have fallen short on a pledge to mobilize $100 billion a year by 2020 in climate financing for poor nations. This has opened up a rift of distrust that negotiators are hoping to close with fresh pledges. But needs are growing and a new, higher target needs to be set from 2025 onward.\n\nAminath Shauna, the environment minister of the Maldives, said her island nation conservatively estimates that it will need $8 billion for coastal adaptation. And even that may not be enough, if sea levels rise too much. “It is very disheartening to see that it may be too late for the Maldives, but we still need to address (the issue of finance),” she said.\n\nCOMPENSATION\n\nThe subject of climate compensation was once considered taboo, due to concerns from rich countries that they might be on the hook for vast sums. But intense pressure from developing countries forced the issue of “loss and damage” onto the formal agenda at the talks for the first time this year. Whether there will be a deal to promote further technical work or the creation of an actual fund remains to be seen.\n\nJohn Kerry said the United States is hopeful of getting an agreement “before 2024” but suggested this might not come to pass in Egypt. But he made it clear where the U.S. red line lies for Washington: ”The United States and many other countries will not establish some ... legal structure that is a tied to compensation or liability.\" That doesn't mean money won't flow, eventually. But it might be branded as aid, tied into existing funds and require contributions from all major emitters if it's to pass.\n\nMORE DONORS\n\nOne way to raise additional cash and resolve the thorny issue of polluter payment would be for those countries that have seen an economic boom in the past three decades to step up. The focus is chiefly on China, the world’s biggest emitter, but others could be asked to open their purses too.\n\nSIDE DEALS\n\nLast year's meeting saw a raft of agreements signed which weren't formally part of the talks. Some have also been unveiled in Egypt, though hopes for a series of announcements on Just Transition Partnerships — where developed countries help poorer nations wean themselves off fossil fuels — aren't likely to bear fruit until after COP27.\n\nHOPE TILL THE END\n\nJennifer Morgan, a former head of Greenpeace who recently became Germany's climate envoy, called the talks this year “challenging.”\n\n“But I can promise you we will be working until the very last second to ensure that we can reach an ambitious and equitable outcome,” she said. “We are reaching for the stars while keeping our feet on the ground.”"}
        ],
        
        set_input_text(text) {
            this.input_text = text
        },

        async summarize(action="summarize") {
            const rawResponse = await fetch('https://asia-southeast1-carbcrunch.cloudfunctions.net/summarize', {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    "text": this.input_text,
                    "action": action
                })
            });
            const content = await rawResponse.json();
            console.log(content);
            this.output_text = content["summary"];
        }
    })
    Alpine.data('text_input', () => ({
        rephrase_open: false,
        create_open: false,
        rephrase_options: [
            {"id": "rephrase_public", "text": "General Public"},
            {"id": "rephrase_business", "text": "Business Leaders"},
            {"id": "rephrase_policymakers", "text": "Policy Makers"}
        ],
        create_options: [
            {"id": "create_email", "text": "Email"},
            {"id": "create_policy", "text": "Policy"},
            {"id": "create_press_release", "text": "Press Release"},
            {"id": "create_petition", "text": "Petition"},
            {"id": "create_tweet", "text": "Tweet"},
        ],

        rephrase_dropdown: {
            ['@click']() {
                this.rephrase_open = !this.rephrase_open;
            },
            ['@click.outside']() {
                this.rephrase_open = false;
            }
        },
        create_dropdown: {
            ['@click']() {
                this.create_open = !this.create_open;
            },
            ['@click.outside']() {
                this.create_open = false;
            }
        },
    }));
    console.log("main.js loaded")
    try {
        const data = getData()
        this.news_feed = data["news"]
    } catch(error) {
        console.error(error)
    }
})

// const summarize = async (text) => {
//         const rawResponse = await fetch('https://asia-southeast1-carbcrunch.cloudfunctions.net/summarize', {
//           method: 'POST',
//           headers: {
//             'Accept': 'application/json',
//             'Content-Type': 'application/json'
//           },
//           body: JSON.stringify({
//             "text": "I loved your pie",
//             "action": "create_email"
//           })
//         });
//         const content = await rawResponse.json();
      
//         console.log(content);
//     }